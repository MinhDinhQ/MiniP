@page "/createcomment"
@using kreddit_app.Data
@using shared.Model
@inject ApiService apiService
@inject NavigationManager Navigation;

<div>
    <br />
    <h3>Write a comment</h3>
    <input placeholder="Content" type="input" id="content" @bind-value="content" />
    <button id="createPostButton" type="button" @onclick="CreateNewComment">Post comment</button>
</div>

@code {
    [Parameter]
    public int PostId { get; set; }  // Modtag PostId som parameter

    [Parameter]
    public EventCallback<Comment> OnCommentCreated { get; set; }  // Callback til at sende den nye kommentar tilbage

    private string? content;

    private async Task CreateNewComment()
    {
        if (string.IsNullOrWhiteSpace(content))
        {
            return;  // Hvis indholdet er tomt, g√∏r vi ikke noget
        }

        // Opret kommentar
        var newComment = await apiService.CreateComment(content, PostId, "Kasper");

        // Send den nye kommentar til PostItem-komponenten
        if (newComment != null)
        {
            await OnCommentCreated.InvokeAsync(newComment);
        }
    }

    private void NavigateToHome()
    {
        Navigation.NavigateTo("/");
    }
}
